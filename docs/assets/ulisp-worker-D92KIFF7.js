var ir=Object.defineProperty;var or=(B,D,G)=>D in B?ir(B,D,{enumerable:!0,configurable:!0,writable:!0,value:G}):B[D]=G;var Se=(B,D,G)=>or(B,typeof D!="symbol"?D+"":D,G);(function(){"use strict";var B=(()=>{var F,x;var M=(x=(F=globalThis.document)==null?void 0:F.currentScript)==null?void 0:x.src;return async function(v={}){var A;(function(){var d,p,E,P;function e(L){L=L.split("-")[0];for(var N=L.split(".").slice(0,3);N.length<3;)N.push("00");return N=N.map((z,ge,ve)=>z.padStart(2,"0")),N.join("")}var t=L=>[L/1e4|0,(L/100|0)%100,L%100].join("."),r=2147483647,o=typeof process<"u"&&((d=process.versions)!=null&&d.node)?e(process.versions.node):r;if(o<r)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");if(o<2147483647)throw new Error(`This emscripten-generated code requires node v${t(2147483647)} (detected v${t(o)})`);var s=typeof navigator<"u"&&((p=navigator.userAgent)!=null&&p.includes("Safari/"))&&navigator.userAgent.match(/Version\/(\d+\.?\d*\.?\d*)/)?e(navigator.userAgent.match(/Version\/(\d+\.?\d*\.?\d*)/)[1]):r;if(s<15e4)throw new Error(`This emscripten-generated code requires Safari v${t(15e4)} (detected v${s})`);var u=typeof navigator<"u"&&((E=navigator.userAgent)!=null&&E.match(/Firefox\/(\d+(?:\.\d+)?)/))?parseFloat(navigator.userAgent.match(/Firefox\/(\d+(?:\.\d+)?)/)[1]):r;if(u<79)throw new Error(`This emscripten-generated code requires Firefox v79 (detected v${u})`);var c=typeof navigator<"u"&&((P=navigator.userAgent)!=null&&P.match(/Chrome\/(\d+(?:\.\d+)?)/))?parseFloat(navigator.userAgent.match(/Chrome\/(\d+(?:\.\d+)?)/)[1]):r;if(c<85)throw new Error(`This emscripten-generated code requires Chrome v85 (detected v${c})`)})();var n=v,I=(e,t)=>{throw t},b="";function f(e){return n.locateFile?n.locateFile(e,b):b+e}var w;{try{b=new URL(".",M).href}catch{}if(!(globalThis.window||globalThis.WorkerGlobalScope))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");w=async e=>{a(!he(e),"readAsync does not work with file:// URLs");var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var y=console.log.bind(console),l=console.error.bind(console);a(!0,"worker environment detected but not enabled at build time.  Add `worker` to `-sENVIRONMENT` to enable."),a(!0,"node environment detected but not enabled at build time.  Add `node` to `-sENVIRONMENT` to enable."),a(!0,"shell environment detected but not enabled at build time.  Add `shell` to `-sENVIRONMENT` to enable.");var S;globalThis.WebAssembly||l("no native wasm support detected");var m=!1,O;function a(e,t){e||g("Assertion failed"+(t?": "+t:""))}var he=e=>e.startsWith("file://");function Qe(){var e=pe();a((e&3)==0),e==0&&(e+=4),T[e>>2]=34821223,T[e+4>>2]=2310721022,T[0]=1668509029}function X(){if(!m){var e=pe();e==0&&(e+=4);var t=T[e>>2],r=T[e+4>>2];(t!=34821223||r!=2310721022)&&g(`Stack overflow! Stack cookie has been overwritten at ${j(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${j(r)} ${j(t)}`),T[0]!=1668509029&&g("Runtime error: The application has corrupted its heap memory area (address zero)!")}}(()=>{var e=new Int16Array(1),t=new Int8Array(e.buffer);e[0]=25459,(t[0]!==115||t[1]!==99)&&g("Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)")})();function Z(e){Object.getOwnPropertyDescriptor(n,e)||Object.defineProperty(n,e,{configurable:!0,set(){g(`Attempt to set \`Module.${e}\` after it has already been processed.  This can happen, for example, when code is injected via '--post-js' rather than '--pre-js'`)}})}function _(e){return()=>a(!1,`call to '${e}' via reference taken before Wasm module initialization`)}function et(e){Object.getOwnPropertyDescriptor(n,e)&&g(`\`Module.${e}\` was supplied but \`${e}\` not included in INCOMING_MODULE_JS_API`)}function tt(e){return e==="FS_createPath"||e==="FS_createDataFile"||e==="FS_createPreloadedFile"||e==="FS_preloadFile"||e==="FS_unlink"||e==="addRunDependency"||e==="FS_createLazyFile"||e==="FS_createDevice"||e==="removeRunDependency"}function rt(e){Fe(e)}function Fe(e){Object.getOwnPropertyDescriptor(n,e)||Object.defineProperty(n,e,{configurable:!0,get(){var t=`'${e}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;tt(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),g(t)}})}var Q,$,se,H,ee,T,we,be,te=!1;function nt(){var e=qe.buffer;se=new Int8Array(e),H=new Uint8Array(e),ee=new Int32Array(e),T=new Uint32Array(e),we=new Float64Array(e),be=new BigInt64Array(e),new BigUint64Array(e)}a(globalThis.Int32Array&&globalThis.Float64Array&&Int32Array.prototype.subarray&&Int32Array.prototype.set,"JS engine does not provide full typed array support");function at(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)mt(n.preRun.shift());Z("preRun"),ke(Ae)}function it(){a(!te),te=!0,X(),W.__wasm_call_ctors()}function ot(){if(X(),n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)pt(n.postRun.shift());Z("postRun"),ke(Ee)}function g(e){var r;(r=n.onAbort)==null||r.call(n,e),e="Aborted("+e+")",l(e),m=!0,e.indexOf("RuntimeError: unreachable")>=0&&(e+='. "unreachable" may be due to ASYNCIFY_STACK_SIZE not being large enough (try increasing it)');var t=new WebAssembly.RuntimeError(e);throw $==null||$(t),t}var C={error(){g("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with -sFORCE_FILESYSTEM")},init(){C.error()},createDataFile(){C.error()},createPreloadedFile(){C.error()},createLazyFile(){C.error()},open(){C.error()},mkdev(){C.error()},registerDevice(){C.error()},analyzePath(){C.error()},ErrnoError(){C.error()}};function h(e,t){return(...r)=>{a(te,`native function \`${e}\` called before runtime initialization`);var o=W[e];return a(o,`exported native function \`${e}\` not found`),a(r.length<=t,`native function \`${e}\` called with ${r.length} args but expects ${t}`),o(...r)}}var le;function st(){return f("ulisp.wasm")}function lt(e){if(e==le&&S)return new Uint8Array(S);throw"both async and sync fetching of the wasm failed"}async function ct(e){if(!S)try{var t=await w(e);return new Uint8Array(t)}catch{}return lt(e)}async function dt(e,t){try{var r=await ct(e),o=await WebAssembly.instantiate(r,t);return o}catch(s){l(`failed to asynchronously prepare wasm: ${s}`),he(e)&&l(`warning: Loading from a file URI (${e}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),g(s)}}async function ut(e,t,r){if(!e)try{var o=fetch(t,{credentials:"same-origin"}),s=await WebAssembly.instantiateStreaming(o,r);return s}catch(u){l(`wasm streaming compile failed: ${u}`),l("falling back to ArrayBuffer instantiation")}return dt(t,r)}function ft(){i.instrumentWasmImports(ye);var e={env:ye,wasi_snapshot_preview1:ye};return e}async function _t(){function e(c,d){return W=c.exports,W=i.instrumentWasmExports(W),Xt(W),nt(),W}var t=n;function r(c){return a(n===t,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),t=null,e(c.instance)}var o=ft();if(n.instantiateWasm)return new Promise((c,d)=>{try{n.instantiateWasm(o,(p,E)=>{c(e(p,E))})}catch(p){l(`Module.instantiateWasm callback failed with error: ${p}`),d(p)}});le??(le=st());var s=await ut(S,le,o),u=r(s);return u}class Te{constructor(t){Se(this,"name","ExitStatus");this.message=`Program terminated with exit(${t})`,this.status=t}}var ke=e=>{for(;e.length>0;)e.shift()(n)},Ee=[],pt=e=>Ee.push(e),Ae=[],mt=e=>Ae.push(e),Ce=!0,j=e=>(a(typeof e=="number",`ptrToString expects a number, got ${typeof e}`),e>>>=0,"0x"+e.toString(16).padStart(8,"0")),V=e=>We(e),Y=()=>me(),U=e=>{U.shown||(U.shown={}),U.shown[e]||(U.shown[e]=1,l(e))},Me=globalThis.TextDecoder&&new TextDecoder,yt=(e,t,r,o)=>{var s=t+r;if(o)return s;for(;e[t]&&!(t>=s);)++t;return t},Ie=(e,t=0,r,o)=>{var s=yt(e,t,r,o);if(s-t>16&&e.buffer&&Me)return Me.decode(e.subarray(t,s));for(var u="";t<s;){var c=e[t++];if(!(c&128)){u+=String.fromCharCode(c);continue}var d=e[t++]&63;if((c&224)==192){u+=String.fromCharCode((c&31)<<6|d);continue}var p=e[t++]&63;if((c&240)==224?c=(c&15)<<12|d<<6|p:((c&248)!=240&&U("Invalid UTF-8 leading byte "+j(c)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),c=(c&7)<<18|d<<12|p<<6|e[t++]&63),c<65536)u+=String.fromCharCode(c);else{var E=c-65536;u+=String.fromCharCode(55296|E>>10,56320|E&1023)}}return u},R=(e,t,r)=>(a(typeof e=="number",`UTF8ToString expects a number (got ${typeof e})`),e?Ie(H,e,t,r):""),gt=(e,t,r,o)=>g(`Assertion failed: ${R(e)}, at: `+[t?R(t):"unknown filename",r,o?R(o):"unknown function"]),vt=()=>g("native code called abort()"),St=()=>{throw 1/0},re=[],ht=(e,t)=>{a(Array.isArray(re)),a(t%16==0),re.length=0;for(var r;r=H[e++];){var o=String.fromCharCode(r),s=["d","f","i","p"];s.push("j"),a(s.includes(o),`Invalid character ${r}("${o}") in readEmAsmArgs! Use only [${s}], and do not specify "v" for void return argument.`);var u=r!=105;u&=r!=112,t+=u&&t%8?4:0,re.push(r==112?T[t>>2]:r==106?be[t>>3]:r==105?ee[t>>2]:we[t>>3]),t+=u?8:4}return re},Re=(e,t,r)=>{var o=ht(t,r);return a(xe.hasOwnProperty(e),`No EM_ASM constant found at address ${e}.  The loaded WebAssembly file is likely out of sync with the generated JavaScript.`),xe[e](...o)},Ft=(e,t,r)=>Re(e,t,r),wt=(e,t,r)=>Re(e,t,r),bt=e=>{g(`Cannot enlarge memory arrays to size ${e} bytes (OOM). Either (1) compile with -sINITIAL_MEMORY=X with X higher than the current value ${se.length}, (2) compile with -sALLOW_MEMORY_GROWTH which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with -sABORTING_MALLOC=0`)},Tt=e=>{H.length,e>>>=0,bt(e)},kt=e=>{g("fd_close called without SYSCALLS_REQUIRE_FILESYSTEM")};function Et(e,t,r,o){return 70}var ce=[null,[],[]],de=(e,t)=>{var r=ce[e];a(r),t===0||t===10?((e===1?y:l)(Ie(r)),r.length=0):r.push(t)},At=()=>{Ue(0),ce[1].length&&de(1,10),ce[2].length&&de(2,10)},Ct=(e,t,r,o)=>{for(var s=0,u=0;u<r;u++){var c=T[t>>2],d=T[t+4>>2];t+=8;for(var p=0;p<d;p++)de(e,H[c+p]);s+=d}return T[o>>2]=s,0},ne=e=>{try{return e()}catch(t){g(t)}},Pe=e=>{if(e instanceof Te||e=="unwind")return O;X(),e instanceof WebAssembly.RuntimeError&&me()<=0&&l("Stack overflow detected.  You can try increasing -sSTACK_SIZE (currently set to 65536)"),I(1,e)},J=0,ue=()=>Ce||J>0,Mt=e=>{var t;O=e,ue()||((t=n.onExit)==null||t.call(n,e),m=!0),I(e,new Te(e))},It=(e,t)=>{if(O=e,ar(),ue()&&!t){var r=`program exited (with status: ${e}), but keepRuntimeAlive() is set (counter=${J}) due to an async operation, so halting execution but not exiting the runtime or preventing further async execution (you can use emscripten_force_exit, if you want to force a true shutdown)`;$==null||$(r),l(r)}Mt(e)},Rt=It,Pt=()=>{if(!ue())try{Rt(O)}catch(e){Pe(e)}},Lt=e=>{if(m){l("user callback triggered after runtime exited or application aborted.  Ignoring.");return}try{e(),Pt()}catch(t){Pe(t)}},Dt=(e,t)=>Object.defineProperty(t,"name",{value:e}),xt=()=>{J+=1},Ot=()=>{a(J>0),J-=1},i={instrumentWasmImports(e){var t=/^(invoke_.*|__asyncjs__.*)$/;for(let[r,o]of Object.entries(e))if(typeof o=="function"){let s=o.isAsync||t.test(r);e[r]=(...u)=>{var c=i.state;try{return o(...u)}finally{var d=c===i.State.Normal&&i.state===i.State.Disabled,p=r.startsWith("invoke_")&&!0;i.state!==c&&!s&&!d&&!p&&g(`import ${r} was not in ASYNCIFY_IMPORTS, but changed the state`)}}}},instrumentFunction(e){var t=(...r)=>{i.exportCallStack.push(e);try{return e(...r)}finally{if(!m){var o=i.exportCallStack.pop();a(o===e),i.maybeStopUnwind()}}};return i.funcWrappers.set(e,t),t=Dt(`__asyncify_wrapper_${e.name}`,t),t},instrumentWasmExports(e){var t={};for(let[o,s]of Object.entries(e))if(typeof s=="function"){var r=i.instrumentFunction(s);t[o]=r}else t[o]=s;return t},State:{Normal:0,Unwinding:1,Rewinding:2,Disabled:3},state:0,StackSize:4096,currData:null,handleSleepReturnValue:0,exportCallStack:[],callstackFuncToId:new Map,callStackIdToFunc:new Map,funcWrappers:new Map,callStackId:0,asyncPromiseHandlers:null,sleepCallbacks:[],getCallStackId(e){if(a(e),!i.callstackFuncToId.has(e)){var t=i.callStackId++;i.callstackFuncToId.set(e,t),i.callStackIdToFunc.set(t,e)}return i.callstackFuncToId.get(e)},maybeStopUnwind(){i.currData&&i.state===i.State.Unwinding&&i.exportCallStack.length===0&&(i.state=i.State.Normal,ne(Ve),typeof Fibers<"u"&&Fibers.trampoline())},whenDone(){return a(i.currData,"Tried to wait for an async operation when none is in progress."),a(!i.asyncPromiseHandlers,"Cannot have multiple async operations in flight at once"),new Promise((e,t)=>{i.asyncPromiseHandlers={resolve:e,reject:t}})},allocateData(){var e=ae(12+i.StackSize);return i.setDataHeader(e,e+12,i.StackSize),i.setDataRewindFunc(e),e},setDataHeader(e,t,r){T[e>>2]=t,T[e+4>>2]=t+r},setDataRewindFunc(e){var t=i.exportCallStack[0];a(t,"exportCallStack is empty");var r=i.getCallStackId(t);ee[e+8>>2]=r},getDataRewindFunc(e){var t=ee[e+8>>2],r=i.callStackIdToFunc.get(t);return a(r,`id ${t} not found in callStackIdToFunc`),r},doRewind(e){var t=i.getDataRewindFunc(e),r=i.funcWrappers.get(t);return a(t),a(r),r()},handleSleep(e){if(a(i.state!==i.State.Disabled,"Asyncify cannot be done during or after the runtime exits"),!m){if(i.state===i.State.Normal){var t=!1,r=!1;e((o=0)=>{if(a(!o||typeof o=="number"||typeof o=="boolean"),!m&&(i.handleSleepReturnValue=o,t=!0,!!r)){a(!i.exportCallStack.length,"Waking up (starting to rewind) must be done from JS, without compiled code on the stack."),i.state=i.State.Rewinding,ne(()=>Ye(i.currData)),typeof MainLoop<"u"&&MainLoop.func&&MainLoop.resume();var s,u=!1;try{s=i.doRewind(i.currData)}catch(p){s=p,u=!0}var c=!1;if(!i.currData){var d=i.asyncPromiseHandlers;d&&(i.asyncPromiseHandlers=null,(u?d.reject:d.resolve)(s),c=!0)}if(u&&!c)throw s}}),r=!0,t||(i.state=i.State.Unwinding,i.currData=i.allocateData(),typeof MainLoop<"u"&&MainLoop.func&&MainLoop.pause(),ne(()=>je(i.currData)))}else i.state===i.State.Rewinding?(i.state=i.State.Normal,ne(Je),Oe(i.currData),i.currData=null,i.sleepCallbacks.forEach(Lt)):g(`invalid state: ${i.state}`);return i.handleSleepReturnValue}},handleAsync:e=>i.handleSleep(t=>{e().then(t).catch(()=>{})})},Ut=e=>{var t=n["_"+e];return a(t,"Cannot call unknown function "+e+", make sure it is exported"),t},Nt=(e,t)=>{a(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),se.set(e,t)},fe=e=>{for(var t=0,r=0;r<e.length;++r){var o=e.charCodeAt(r);o<=127?t++:o<=2047?t+=2:o>=55296&&o<=57343?(t+=4,++r):t+=3}return t},Wt=(e,t,r,o)=>{if(a(typeof e=="string",`stringToUTF8Array expects a string (got ${typeof e})`),!(o>0))return 0;for(var s=r,u=r+o-1,c=0;c<e.length;++c){var d=e.codePointAt(c);if(d<=127){if(r>=u)break;t[r++]=d}else if(d<=2047){if(r+1>=u)break;t[r++]=192|d>>6,t[r++]=128|d&63}else if(d<=65535){if(r+2>=u)break;t[r++]=224|d>>12,t[r++]=128|d>>6&63,t[r++]=128|d&63}else{if(r+3>=u)break;d>1114111&&U("Invalid Unicode code point "+j(d)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),t[r++]=240|d>>18,t[r++]=128|d>>12&63,t[r++]=128|d>>6&63,t[r++]=128|d&63,c++}}return t[r]=0,r-s},_e=(e,t,r)=>(a(typeof r=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Wt(e,H,t,r)),Le=e=>Be(e),Bt=e=>{var t=fe(e)+1,r=Le(t);return _e(e,r,t),r},De=(e,t,r,o,s)=>{var u={string:k=>{var K=0;return k!=null&&k!==0&&(K=Bt(k)),K},array:k=>{var K=Le(k.length);return Nt(k,K),K}};function c(k){return t==="string"?R(k):t==="boolean"?!!k:k}var d=Ut(e),p=[],E=0;if(a(t!=="array",'Return type should not be "array".'),o)for(var P=0;P<o.length;P++){var L=u[r[P]];L?(E===0&&(E=Y()),p[P]=L(o[P])):p[P]=o[P]}var N=i.currData,z=d(...p);function ge(k){return Ot(),E!==0&&V(E),c(k)}var ve=s==null?void 0:s.async;return xt(),i.currData!=N?(a(!(N&&i.currData),"We cannot start an async operation when one is already flight"),a(!(N&&!i.currData),"We cannot stop an async operation in flight"),a(ve,"The call to "+e+" is running asynchronously. If this was intended, add the async option to the ccall/cwrap call."),i.whenDone().then(ge)):(z=ge(z),ve?Promise.resolve(z):z)},$t=(e,t,r,o)=>(...s)=>De(e,t,r,s,o),Gt=e=>{var t=fe(e)+1,r=ae(t);return r&&_e(e,r,t),r};{if(n.noExitRuntime&&(Ce=n.noExitRuntime),n.print&&(y=n.print),n.printErr&&(l=n.printErr),n.wasmBinary&&(S=n.wasmBinary),n.FS_createDataFile=C.createDataFile,n.FS_createPreloadedFile=C.createPreloadedFile,jt(),n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,a(typeof n.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),a(typeof n.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),a(typeof n.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),a(typeof n.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),a(typeof n.read>"u","Module.read option was removed"),a(typeof n.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),a(typeof n.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),a(typeof n.setWindowTitle>"u","Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),a(typeof n.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),a(typeof n.ENVIRONMENT>"u","Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)"),a(typeof n.STACK_SIZE>"u","STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),a(typeof n.wasmMemory>"u","Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),a(typeof n.INITIAL_MEMORY>"u","Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically"),n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()();Z("preInit")}n.ccall=De,n.cwrap=$t,n.UTF8ToString=R,n.stringToNewUTF8=Gt;var Ht=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertI32PairToI53Checked","convertU32PairToI53","getTempRet0","setTempRet0","zeroMemory","getHeapMax","growMemory","withStackSave","strError","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","runMainThreadEmAsm","jstoi_q","getExecutableName","autoResumeAudioContext","getDynCaller","asyncLoad","asmjsMangle","alignMemory","mmapAlloc","HandleAllocator","getUniqueRunDependency","addRunDependency","removeRunDependency","addOnInit","addOnPostCtor","addOnPreMain","addOnExit","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","intArrayFromString","intArrayToString","AsciiToString","stringToAscii","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","getEnvStrings","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","initRandomFill","randomFill","safeSetTimeout","setImmediateWrapped","safeRequestAnimationFrame","clearImmediateWrapped","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","isLeapYear","ydayFromDate","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_createPreloadedFile","FS_preloadFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","allocateUTF8","allocateUTF8OnStack","demangle","stackTrace","getNativeTypeSize"];Ht.forEach(rt);var zt=["run","out","err","callMain","abort","wasmExports","HEAPF32","HEAPF64","HEAP8","HEAPU8","HEAP16","HEAPU16","HEAP32","HEAPU32","HEAP64","HEAPU64","writeStackCookie","checkStackCookie","INT53_MAX","INT53_MIN","bigintToI53Checked","stackSave","stackRestore","stackAlloc","createNamedFunction","ptrToString","exitJS","abortOnCannotGrowMemory","ENV","ERRNO_CODES","DNS","Protocols","Sockets","timers","warnOnce","readEmAsmArgsArray","readEmAsmArgs","runEmAsmFunction","dynCallLegacy","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","wasmTable","wasmMemory","noExitRuntime","addOnPreRun","addOnPostRun","freeTableIndexes","functionsInTableMap","setValue","getValue","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","stringToUTF8","lengthBytesUTF8","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","flush_NO_FILESYSTEM","emSetImmediate","emClearImmediate_deps","emClearImmediate","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","requestFullscreen","requestFullScreen","setCanvasSize","getUserMedia","createContext","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","SYSCALLS","preloadPlugins","FS_stdin_getChar_buffer","FS_unlink","FS_createPath","FS_createDevice","FS_readFile","FS","FS_root","FS_mounts","FS_devices","FS_streams","FS_nextInode","FS_nameTable","FS_currentPath","FS_initialized","FS_ignorePermissions","FS_filesystems","FS_syncFSRequests","FS_readFiles","FS_lookupPath","FS_getPath","FS_hashName","FS_hashAddNode","FS_hashRemoveNode","FS_lookupNode","FS_createNode","FS_destroyNode","FS_isRoot","FS_isMountpoint","FS_isFile","FS_isDir","FS_isLink","FS_isChrdev","FS_isBlkdev","FS_isFIFO","FS_isSocket","FS_flagsToPermissionString","FS_nodePermissions","FS_mayLookup","FS_mayCreate","FS_mayDelete","FS_mayOpen","FS_checkOpExists","FS_nextfd","FS_getStreamChecked","FS_getStream","FS_createStream","FS_closeStream","FS_dupStream","FS_doSetAttr","FS_chrdev_stream_ops","FS_major","FS_minor","FS_makedev","FS_registerDevice","FS_getDevice","FS_getMounts","FS_syncfs","FS_mount","FS_unmount","FS_lookup","FS_mknod","FS_statfs","FS_statfsStream","FS_statfsNode","FS_create","FS_mkdir","FS_mkdev","FS_symlink","FS_rename","FS_rmdir","FS_readdir","FS_readlink","FS_stat","FS_fstat","FS_lstat","FS_doChmod","FS_chmod","FS_lchmod","FS_fchmod","FS_doChown","FS_chown","FS_lchown","FS_fchown","FS_doTruncate","FS_truncate","FS_ftruncate","FS_utime","FS_open","FS_close","FS_isClosed","FS_llseek","FS_read","FS_write","FS_mmap","FS_msync","FS_ioctl","FS_writeFile","FS_cwd","FS_chdir","FS_createDefaultDirectories","FS_createDefaultDevices","FS_createSpecialDirectories","FS_createStandardStreams","FS_staticInit","FS_init","FS_quit","FS_findObject","FS_analyzePath","FS_createFile","FS_createDataFile","FS_forceLoadFile","FS_createLazyFile","FS_absolutePath","FS_createFolder","FS_createLink","FS_joinPath","FS_mmapAlloc","FS_standardizePath","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","runAndAbortIfError","Asyncify","Fibers","SDL","SDL_gfx","print","printErr","jstoi_s"];zt.forEach(Fe);function jt(){et("fetchSettings")}var xe={54816:()=>performance.now(),54846:e=>performance.now()-e,54881:(e,t)=>globalThis.ulisp.call(R(e),t),54937:(e,t,r)=>{globalThis.ulisp.call(R(e),t,r)},54990:(e,t)=>globalThis.ulisp.call(R(e),t),55046:(e,t,r)=>{globalThis.ulisp.call(R(e),t,r)},55099:(e,t,r)=>{globalThis.ulisp.call(R(e),t,r)}};function Vt(e){return i.handleAsync(async()=>{await globalThis.ulisp.delay(e)})}function Yt(){return i.handleAsync(async()=>{const e=await globalThis.ulisp.readLine(),t=fe(e)+1,r=ae(t);return _e(e,r,t),r})}function Jt(e){return i.handleAsync(async()=>{const t=await globalThis.ulisp.readByte(e);return t===-1?-1:t<0||t>255?(console.error("Invalid byte generated",t),-1):t})}function qt(e,t){globalThis.ulisp.writeByte(e,t)}function Kt(){return globalThis.ulisp.wait_for_tick()}var Oe=n._free=_("_free"),Ue=_("_fflush");n._print_version=_("_print_version"),n._setup=_("_setup"),n._stop_loop=_("_stop_loop"),n._evaluate=_("_evaluate");var pe=_("_emscripten_stack_get_end"),ae=_("_malloc"),q=_("_setThrew"),Ne=_("_emscripten_stack_init"),We=_("__emscripten_stack_restore"),Be=_("__emscripten_stack_alloc"),me=_("_emscripten_stack_get_current"),$e=_("dynCall_vi"),Ge=_("dynCall_vii"),He=_("dynCall_ii"),ze=_("dynCall_iii"),je=_("_asyncify_start_unwind"),Ve=_("_asyncify_stop_unwind"),Ye=_("_asyncify_start_rewind"),Je=_("_asyncify_stop_rewind"),qe=_("wasmMemory");function Xt(e){a(typeof e.free<"u","missing Wasm export: free"),Oe=n._free=h("free",1),a(typeof e.fflush<"u","missing Wasm export: fflush"),Ue=h("fflush",1),a(typeof e.print_version<"u","missing Wasm export: print_version"),n._print_version=h("print_version",0),a(typeof e.setup<"u","missing Wasm export: setup"),n._setup=h("setup",0),a(typeof e.stop_loop<"u","missing Wasm export: stop_loop"),n._stop_loop=h("stop_loop",0),a(typeof e.evaluate<"u","missing Wasm export: evaluate"),n._evaluate=h("evaluate",1),a(typeof e.emscripten_stack_get_end<"u","missing Wasm export: emscripten_stack_get_end"),pe=e.emscripten_stack_get_end,a(typeof e.emscripten_stack_get_base<"u","missing Wasm export: emscripten_stack_get_base"),e.emscripten_stack_get_base,a(typeof e.strerror<"u","missing Wasm export: strerror"),a(typeof e.malloc<"u","missing Wasm export: malloc"),ae=h("malloc",1),a(typeof e.setThrew<"u","missing Wasm export: setThrew"),q=h("setThrew",2),a(typeof e.emscripten_stack_init<"u","missing Wasm export: emscripten_stack_init"),Ne=e.emscripten_stack_init,a(typeof e.emscripten_stack_get_free<"u","missing Wasm export: emscripten_stack_get_free"),e.emscripten_stack_get_free,a(typeof e._emscripten_stack_restore<"u","missing Wasm export: _emscripten_stack_restore"),We=e._emscripten_stack_restore,a(typeof e._emscripten_stack_alloc<"u","missing Wasm export: _emscripten_stack_alloc"),Be=e._emscripten_stack_alloc,a(typeof e.emscripten_stack_get_current<"u","missing Wasm export: emscripten_stack_get_current"),me=e.emscripten_stack_get_current,a(typeof e.dynCall_vi<"u","missing Wasm export: dynCall_vi"),$e=h("dynCall_vi",2),a(typeof e.dynCall_i<"u","missing Wasm export: dynCall_i"),a(typeof e.dynCall_vii<"u","missing Wasm export: dynCall_vii"),Ge=h("dynCall_vii",3),a(typeof e.dynCall_ii<"u","missing Wasm export: dynCall_ii"),He=h("dynCall_ii",2),a(typeof e.dynCall_iii<"u","missing Wasm export: dynCall_iii"),ze=h("dynCall_iii",3),a(typeof e.dynCall_iiii<"u","missing Wasm export: dynCall_iiii"),a(typeof e.dynCall_jiji<"u","missing Wasm export: dynCall_jiji"),a(typeof e.asyncify_start_unwind<"u","missing Wasm export: asyncify_start_unwind"),je=h("asyncify_start_unwind",1),a(typeof e.asyncify_stop_unwind<"u","missing Wasm export: asyncify_stop_unwind"),Ve=h("asyncify_stop_unwind",0),a(typeof e.asyncify_start_rewind<"u","missing Wasm export: asyncify_start_rewind"),Ye=h("asyncify_start_rewind",1),a(typeof e.asyncify_stop_rewind<"u","missing Wasm export: asyncify_stop_rewind"),Je=h("asyncify_stop_rewind",0),a(typeof e.memory<"u","missing Wasm export: memory"),qe=e.memory,a(typeof e.__indirect_function_table<"u","missing Wasm export: __indirect_function_table"),e.__indirect_function_table}var ye={__assert_fail:gt,__asyncjs__delay_on_host:Vt,__asyncjs__read_byte_from_host:Jt,__asyncjs__read_line_from_host:Yt,_abort_js:vt,_emscripten_throw_longjmp:St,emscripten_asm_const_double:Ft,emscripten_asm_const_int:wt,emscripten_resize_heap:Tt,fd_close:kt,fd_seek:Et,fd_write:Ct,invoke_ii:Qt,invoke_iii:er,invoke_vi:tr,invoke_vii:Zt,wait_for_tick_on_host:Kt,write_byte_to_host:qt};function Zt(e,t,r){var o=Y();try{Ge(e,t,r)}catch(s){if(V(o),s!==s+0)throw s;q(1,0)}}function Qt(e,t){var r=Y();try{return He(e,t)}catch(o){if(V(r),o!==o+0)throw o;q(1,0)}}function er(e,t,r){var o=Y();try{return ze(e,t,r)}catch(s){if(V(o),s!==s+0)throw s;q(1,0)}}function tr(e,t){var r=Y();try{$e(e,t)}catch(o){if(V(r),o!==o+0)throw o;q(1,0)}}var Ke;function rr(){Ne(),Qe()}function nr(){rr(),at();function e(){var t;a(!Ke),Ke=!0,n.calledRun=!0,!m&&(it(),Q==null||Q(n),(t=n.onRuntimeInitialized)==null||t.call(n),Z("onRuntimeInitialized"),a(!n._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),ot())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),e()},1)):e(),X()}function ar(){var e=y,t=l,r=!1;y=l=o=>{r=!0};try{At()}catch{}y=e,l=t,r&&(U("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the Emscripten FAQ), or make sure to emit a newline when you printf etc."),U("(this may also be due to not including full filesystem support - try building with -sFORCE_FILESYSTEM)"))}var W;W=await _t(),nr(),te?A=n:A=new Promise((e,t)=>{Q=e,$=t});for(const e of Object.keys(n))e in v||Object.defineProperty(v,e,{configurable:!0,get(){g(`Access to module property ('${e}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return A}})();class D{constructor(){Se(this,"buffer","")}start(){this.buffer=""}push(F){this.buffer+=F}end(){let F=this.buffer.trimEnd();return this.buffer="",F}}async function G({createLispWasmModule:M,print:F,printError:x,parseJson:v=!0,jsonErrorMode:A="value"}){const n=new D;function I(...y){if(F)return F(...y);n.push(y.reduce((l,S)=>(l+=S,l),"")+`
`)}const b=["value","error","none"].reduce((y,l)=>(y[l]=A===l,y),{}),f=await M({print:I,printErr:x||I});f._setup();async function w(y,l={}){n.start();const S=f.stringToNewUTF8(`(progn ${y})`);await f.ccall("evaluate","void",["number"],[S],{async:!0}),f._free(S);const m=n.end();if(!v)return m;if(m==="nil")return null;if(m==="t")return!0;try{return JSON.parse(m)}catch(O){if(b.none)return;if(b.error)return O.originalValue=m,O;if(b.value)return m}}return{eval:w}}async function Xe(M={}){const{wasmPath:F="",tick:x,print:v,printError:A,readByte:n,writeByte:I,readLine:b}=M;return globalThis.ulisp={call(f,...w){switch(console.log("ulisp called",f,...w),f){case"analogRead":return 0;case"analogWrite":break;case"digitalRead":return 0}},async delay(f=0){return new Promise((w,y)=>{console.log("delay",f),setTimeout(w,parseInt(f,10))})},async readByte(f){return n?await n(f):""},writeByte(f,w){I&&I(f,w)},async readLine(){return b?await b():""},writeLine(f){v&&v(f)},writeLineError(f){A?A(f):v&&v(f)},escape(){return 0},wait_for_tick(){if(x)return x()},stop(){}},await G({print:v,printError:A||v,createLispWasmModule(f={}){return B({...f,locateFile(w,y){return F+w}})}})}let ie;const oe=new Map;async function Ze(M){const{id:F,data:x,action:v,response:A}=M.data;if(v==="response"){const l=oe.get(F);l&&(l(A),oe.delete(F));return}if(v){console.log("Action",v);return}const{code:n,wasmPath:I=""}=x;let b=0;function f(l,...S){const m=`request-${Date.now()}-${Math.random()}`;return self.postMessage({requestId:m,action:l,args:S}),new Promise(O=>{oe.set(m,O)})}function w(l,...S){self.postMessage({action:l,args:S})}ie||(ie=await Xe({wasmPath:I,tick(){b++,self.postMessage({step:b})},print(l){self.postMessage({print:l})},printError(l){self.postMessage({printError:l})},readByte(l){return f("readByte",l)},readLine(){return f("readLine")},async writeByte(l,S){return w("writeByte",l,S)}}));const y=await ie.eval(n);self.postMessage({id:F,result:y})}self.addEventListener("message",function(M){Ze(M)})})();
