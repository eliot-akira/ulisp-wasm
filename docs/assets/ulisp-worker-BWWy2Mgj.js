var nr=Object.defineProperty;var ar=(L,D,G)=>D in L?nr(L,D,{enumerable:!0,configurable:!0,writable:!0,value:G}):L[D]=G;var ge=(L,D,G)=>ar(L,typeof D!="symbol"?D+"":D,G);(function(){"use strict";var L=(()=>{var g;var b=typeof document<"u"?(g=document.currentScript)==null?void 0:g.src:void 0;return async function(R={}){var h,n=R,A,k,C=new Promise((e,t)=>{A=e,k=t}),d={...n},S=(e,t)=>{throw t},p="";function f(e){return n.locateFile?n.locateFile(e,p):p+e}var E;{if(typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),b&&(p=b),p.startsWith("blob:")?p="":p=p.slice(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1),!(typeof window=="object"||typeof WorkerGlobalScope<"u"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");E=async e=>{o(!he(e),"readAsync does not work with file:// URLs");var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var I=n.print||console.log.bind(console),y=n.printErr||console.error.bind(console);Object.assign(n,d),d=null,Pt(),n.arguments&&n.arguments,U("arguments","arguments_"),n.thisProgram&&n.thisProgram,U("thisProgram","thisProgram"),o(typeof n.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),o(typeof n.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),o(typeof n.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),o(typeof n.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),o(typeof n.read>"u","Module.read option was removed"),o(typeof n.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),o(typeof n.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),o(typeof n.setWindowTitle>"u","Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),o(typeof n.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),U("asm","wasmExports"),U("readAsync","readAsync"),U("readBinary","readBinary"),U("setWindowTitle","setWindowTitle"),o(!0,"worker environment detected but not enabled at build time.  Add `worker` to `-sENVIRONMENT` to enable."),o(!0,"node environment detected but not enabled at build time.  Add `node` to `-sENVIRONMENT` to enable."),o(!0,"shell environment detected but not enabled at build time.  Add `shell` to `-sENVIRONMENT` to enable.");var X=n.wasmBinary;U("wasmBinary","wasmBinary"),typeof WebAssembly!="object"&&y("no native wasm support detected");var se,O=!1,je;function o(e,t){e||_("Assertion failed"+(t?": "+t:""))}var le,$,Z,T,_e,we,ce=!1,he=e=>e.startsWith("file://");function Ge(){var e=Pe();o((e&3)==0),e==0&&(e+=4),T[e>>2]=34821223,T[e+4>>2]=2310721022,T[0]=1668509029}function Q(){if(!O){var e=Pe();e==0&&(e+=4);var t=T[e>>2],r=T[e+4>>2];(t!=34821223||r!=2310721022)&&_(`Stack overflow! Stack cookie has been overwritten at ${V(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${V(r)} ${V(t)}`),T[0]!=1668509029&&_("Runtime error: The application has corrupted its heap memory area (address zero)!")}}if((()=>{var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,t[0]!==115||t[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})(),n.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");function U(e,t,r=!0){Object.getOwnPropertyDescriptor(n,e)||Object.defineProperty(n,e,{configurable:!0,get(){let i=r?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";_(`\`Module.${e}\` has been replaced by \`${t}\``+i)}})}function ee(e){Object.getOwnPropertyDescriptor(n,e)||Object.defineProperty(n,e,{configurable:!0,set(){_(`Attempt to set \`Module.${e}\` after it has already been processed.  This can happen, for example, when code is injected via '--post-js' rather than '--pre-js'`)}})}function $e(e){Object.getOwnPropertyDescriptor(n,e)&&_(`\`Module.${e}\` was supplied but \`${e}\` not included in INCOMING_MODULE_JS_API`)}function He(e){return e==="FS_createPath"||e==="FS_createDataFile"||e==="FS_createPreloadedFile"||e==="FS_unlink"||e==="addRunDependency"||e==="FS_createLazyFile"||e==="FS_createDevice"||e==="removeRunDependency"}function ze(e){be(e)}function be(e){Object.getOwnPropertyDescriptor(n,e)||Object.defineProperty(n,e,{configurable:!0,get(){var t=`'${e}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;He(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),_(t)}})}function Ye(){var e=se.buffer;n.HEAP8=le=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAPU8=$=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAP32=Z=new Int32Array(e),n.HEAPU32=T=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=we=new Float64Array(e),n.HEAP64=_e=new BigInt64Array(e),n.HEAPU64=new BigUint64Array(e)}o(!n.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),o(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support"),o(!n.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),o(!n.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");function Ve(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)st(n.preRun.shift());ee("preRun"),Se(Te)}function Je(){o(!ce),ce=!0,Q(),w.__wasm_call_ctors()}function Ke(){if(Q(),n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)ot(n.postRun.shift());ee("postRun"),Se(Ee)}var N=0,H=null,z={},W=null;function qe(e){var t;N++,(t=n.monitorRunDependencies)==null||t.call(n,N),o(!z[e]),z[e]=1,W===null&&typeof setInterval<"u"&&(W=setInterval(()=>{if(O){clearInterval(W),W=null;return}var r=!1;for(var i in z)r||(r=!0,y("still waiting on run dependencies:")),y(`dependency: ${i}`);r&&y("(end of list)")},1e4))}function Xe(e){var r;if(N--,(r=n.monitorRunDependencies)==null||r.call(n,N),o(z[e]),delete z[e],N==0&&(W!==null&&(clearInterval(W),W=null),H)){var t=H;H=null,t()}}function _(e){var r;(r=n.onAbort)==null||r.call(n,e),e="Aborted("+e+")",y(e),O=!0,e.indexOf("RuntimeError: unreachable")>=0&&(e+='. "unreachable" may be due to ASYNCIFY_STACK_SIZE not being large enough (try increasing it)');var t=new WebAssembly.RuntimeError(e);throw k(t),t}var M={error(){_("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with -sFORCE_FILESYSTEM")},init(){M.error()},createDataFile(){M.error()},createPreloadedFile(){M.error()},createLazyFile(){M.error()},open(){M.error()},mkdev(){M.error()},registerDevice(){M.error()},analyzePath(){M.error()},ErrnoError(){M.error()}};n.FS_createDataFile=M.createDataFile,n.FS_createPreloadedFile=M.createPreloadedFile;function v(e,t){return(...r)=>{o(ce,`native function \`${e}\` called before runtime initialization`);var i=w[e];return o(i,`exported native function \`${e}\` not found`),o(r.length<=t,`native function \`${e}\` called with ${r.length} args but expects ${t}`),i(...r)}}var Y;function Ze(){return f("ulisp.wasm")}function Qe(e){if(e==Y&&X)return new Uint8Array(X);throw"both async and sync fetching of the wasm failed"}async function et(e){if(!X)try{var t=await E(e);return new Uint8Array(t)}catch{}return Qe(e)}async function tt(e,t){try{var r=await et(e),i=await WebAssembly.instantiate(r,t);return i}catch(s){y(`failed to asynchronously prepare wasm: ${s}`),he(Y)&&y(`warning: Loading from a file URI (${Y}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),_(s)}}async function rt(e,t,r){if(!e&&typeof WebAssembly.instantiateStreaming=="function")try{var i=fetch(t,{credentials:"same-origin"}),s=await WebAssembly.instantiateStreaming(i,r);return s}catch(u){y(`wasm streaming compile failed: ${u}`),y("falling back to ArrayBuffer instantiation")}return tt(t,r)}function nt(){return a.instrumentWasmImports(me),{env:me,wasi_snapshot_preview1:me}}async function at(){function e(l,c){return w=l.exports,w=a.instrumentWasmExports(w),se=w.memory,o(se,"memory not found in wasm exports"),Ye(),Ce=w.__indirect_function_table,o(Ce,"table not found in wasm exports"),Xe("wasm-instantiate"),w}qe("wasm-instantiate");var t=n;function r(l){return o(n===t,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),t=null,e(l.instance)}var i=nt();if(n.instantiateWasm)return new Promise((l,c)=>{try{n.instantiateWasm(i,(m,x)=>{e(m,x),l(m.exports)})}catch(m){y(`Module.instantiateWasm callback failed with error: ${m}`),c(m)}});Y??(Y=Ze());try{var s=await rt(X,Y,i),u=r(s);return u}catch(l){return k(l),Promise.reject(l)}}class it{constructor(t){ge(this,"name","ExitStatus");this.message=`Program terminated with exit(${t})`,this.status=t}}var Se=e=>{for(;e.length>0;)e.shift()(n)},Ee=[],ot=e=>Ee.unshift(e),Te=[],st=e=>Te.unshift(e);n.noExitRuntime;var V=e=>(o(typeof e=="number"),e>>>=0,"0x"+e.toString(16).padStart(8,"0")),J=e=>Bt(e),K=()=>Le(),B=e=>{B.shown||(B.shown={}),B.shown[e]||(B.shown[e]=1,y(e))},Fe=typeof TextDecoder<"u"?new TextDecoder:void 0,Ae=(e,t=0,r=NaN)=>{for(var i=t+r,s=t;e[s]&&!(s>=i);)++s;if(s-t>16&&e.buffer&&Fe)return Fe.decode(e.subarray(t,s));for(var u="";t<s;){var l=e[t++];if(!(l&128)){u+=String.fromCharCode(l);continue}var c=e[t++]&63;if((l&224)==192){u+=String.fromCharCode((l&31)<<6|c);continue}var m=e[t++]&63;if((l&240)==224?l=(l&15)<<12|c<<6|m:((l&248)!=240&&B("Invalid UTF-8 leading byte "+V(l)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),l=(l&7)<<18|c<<12|m<<6|e[t++]&63),l<65536)u+=String.fromCharCode(l);else{var x=l-65536;u+=String.fromCharCode(55296|x>>10,56320|x&1023)}}return u},P=(e,t)=>(o(typeof e=="number",`UTF8ToString expects a number (got ${typeof e})`),e?Ae($,e,t):""),lt=(e,t,r,i)=>_(`Assertion failed: ${P(e)}, at: `+[t?P(t):"unknown filename",r,i?P(i):"unknown function"]),ct=()=>_("native code called abort()"),ut=()=>{throw 1/0},te=[],dt=(e,t)=>{o(Array.isArray(te)),o(t%16==0),te.length=0;for(var r;r=$[e++];){var i=String.fromCharCode(r),s=["d","f","i","p"];s.push("j"),o(s.includes(i),`Invalid character ${r}("${i}") in readEmAsmArgs! Use only [${s}], and do not specify "v" for void return argument.`);var u=r!=105;u&=r!=112,t+=u&&t%8?4:0,te.push(r==112?T[t>>2]:r==106?_e[t>>3]:r==105?Z[t>>2]:we[t>>3]),t+=u?8:4}return te},ke=(e,t,r)=>{var i=dt(t,r);return o(Re.hasOwnProperty(e),`No EM_ASM constant found at address ${e}.  The loaded WebAssembly file is likely out of sync with the generated JavaScript.`),Re[e](...i)},ft=(e,t,r)=>ke(e,t,r),mt=(e,t,r)=>ke(e,t,r),pt=e=>{_(`Cannot enlarge memory arrays to size ${e} bytes (OOM). Either (1) compile with -sINITIAL_MEMORY=X with X higher than the current value ${le.length}, (2) compile with -sALLOW_MEMORY_GROWTH which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with -sABORTING_MALLOC=0`)},yt=e=>{$.length,e>>>=0,pt(e)},vt=e=>{_("fd_close called without SYSCALLS_REQUIRE_FILESYSTEM")};function gt(e,t,r,i){return 70}var _t=[null,[],[]],wt=(e,t)=>{var r=_t[e];o(r),t===0||t===10?((e===1?I:y)(Ae(r)),r.length=0):r.push(t)},ht=(e,t,r,i)=>{for(var s=0,u=0;u<r;u++){var l=T[t>>2],c=T[t+4>>2];t+=8;for(var m=0;m<c;m++)wt(e,$[l+m]);s+=c}return T[i>>2]=s,0},Ce,re=e=>{try{return e()}catch(t){_(t)}},bt=e=>{if(e instanceof it||e=="unwind")return je;Q(),e instanceof WebAssembly.RuntimeError&&Le()<=0&&y("Stack overflow detected.  You can try increasing -sSTACK_SIZE (currently set to 65536)"),S(1,e)},ue=0,St=()=>{},Et=e=>{if(O){y("user callback triggered after runtime exited or application aborted.  Ignoring.");return}try{e(),St()}catch(t){bt(t)}},Tt=()=>{ue+=1},Ft=()=>{o(ue>0),ue-=1},a={instrumentWasmImports(e){var t=/^(invoke_.*|__asyncjs__.*)$/;for(let[r,i]of Object.entries(e))if(typeof i=="function"){let s=i.isAsync||t.test(r);e[r]=(...u)=>{var l=a.state;try{return i(...u)}finally{var c=l===a.State.Normal&&a.state===a.State.Disabled,m=r.startsWith("invoke_")&&!0;if(a.state!==l&&!s&&!c&&!m)throw new Error(`import ${r} was not in ASYNCIFY_IMPORTS, but changed the state`)}}}},instrumentWasmExports(e){var t={};for(let[r,i]of Object.entries(e))typeof i=="function"?t[r]=(...s)=>{a.exportCallStack.push(r);try{return i(...s)}finally{if(!O){var u=a.exportCallStack.pop();o(u===r),a.maybeStopUnwind()}}}:t[r]=i;return t},State:{Normal:0,Unwinding:1,Rewinding:2,Disabled:3},state:0,StackSize:4096,currData:null,handleSleepReturnValue:0,exportCallStack:[],callStackNameToId:{},callStackIdToName:{},callStackId:0,asyncPromiseHandlers:null,sleepCallbacks:[],getCallStackId(e){var t=a.callStackNameToId[e];return t===void 0&&(t=a.callStackId++,a.callStackNameToId[e]=t,a.callStackIdToName[t]=e),t},maybeStopUnwind(){a.currData&&a.state===a.State.Unwinding&&a.exportCallStack.length===0&&(a.state=a.State.Normal,re(Vt),typeof Fibers<"u"&&Fibers.trampoline())},whenDone(){return o(a.currData,"Tried to wait for an async operation when none is in progress."),o(!a.asyncPromiseHandlers,"Cannot have multiple async operations in flight at once"),new Promise((e,t)=>{a.asyncPromiseHandlers={resolve:e,reject:t}})},allocateData(){var e=pe(12+a.StackSize);return a.setDataHeader(e,e+12,a.StackSize),a.setDataRewindFunc(e),e},setDataHeader(e,t,r){T[e>>2]=t,T[e+4>>2]=t+r},setDataRewindFunc(e){var t=a.exportCallStack[0],r=a.getCallStackId(t);Z[e+8>>2]=r},getDataRewindFuncName(e){var t=Z[e+8>>2],r=a.callStackIdToName[t];return r},getDataRewindFunc(e){var t=w[e];return t},doRewind(e){var t=a.getDataRewindFuncName(e),r=a.getDataRewindFunc(t);return r()},handleSleep(e){if(o(a.state!==a.State.Disabled,"Asyncify cannot be done during or after the runtime exits"),!O){if(a.state===a.State.Normal){var t=!1,r=!1;e((i=0)=>{if(o(!i||typeof i=="number"||typeof i=="boolean"),!O&&(a.handleSleepReturnValue=i,t=!0,!!r)){o(!a.exportCallStack.length,"Waking up (starting to rewind) must be done from JS, without compiled code on the stack."),a.state=a.State.Rewinding,re(()=>Jt(a.currData)),typeof MainLoop<"u"&&MainLoop.func&&MainLoop.resume();var s,u=!1;try{s=a.doRewind(a.currData)}catch(m){s=m,u=!0}var l=!1;if(!a.currData){var c=a.asyncPromiseHandlers;c&&(a.asyncPromiseHandlers=null,(u?c.reject:c.resolve)(s),l=!0)}if(u&&!l)throw s}}),r=!0,t||(a.state=a.State.Unwinding,a.currData=a.allocateData(),typeof MainLoop<"u"&&MainLoop.func&&MainLoop.pause(),re(()=>Yt(a.currData)))}else a.state===a.State.Rewinding?(a.state=a.State.Normal,re(Kt),Nt(a.currData),a.currData=null,a.sleepCallbacks.forEach(Et)):_(`invalid state: ${a.state}`);return a.handleSleepReturnValue}},handleAsync(e){return a.handleSleep(t=>{e().then(t).catch(()=>{})})}},At=e=>{var t=n["_"+e];return o(t,"Cannot call unknown function "+e+", make sure it is exported"),t},kt=(e,t)=>{o(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),le.set(e,t)},de=e=>{for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++r):t+=3}return t},Ct=(e,t,r,i)=>{if(o(typeof e=="string",`stringToUTF8Array expects a string (got ${typeof e})`),!(i>0))return 0;for(var s=r,u=r+i-1,l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c>=55296&&c<=57343){var m=e.charCodeAt(++l);c=65536+((c&1023)<<10)|m&1023}if(c<=127){if(r>=u)break;t[r++]=c}else if(c<=2047){if(r+1>=u)break;t[r++]=192|c>>6,t[r++]=128|c&63}else if(c<=65535){if(r+2>=u)break;t[r++]=224|c>>12,t[r++]=128|c>>6&63,t[r++]=128|c&63}else{if(r+3>=u)break;c>1114111&&B("Invalid Unicode code point "+V(c)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),t[r++]=240|c>>18,t[r++]=128|c>>12&63,t[r++]=128|c>>6&63,t[r++]=128|c&63}}return t[r]=0,r-s},fe=(e,t,r)=>(o(typeof r=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Ct(e,$,t,r)),Ie=e=>jt(e),It=e=>{var t=de(e)+1,r=Ie(t);return fe(e,r,t),r},Me=(e,t,r,i,s)=>{var u={string:F=>{var q=0;return F!=null&&F!==0&&(q=It(F)),q},array:F=>{var q=Ie(F.length);return kt(F,q),q}};function l(F){return t==="string"?P(F):t==="boolean"?!!F:F}var c=At(e),m=[],x=0;if(o(t!=="array",'Return type should not be "array".'),i)for(var j=0;j<i.length;j++){var xe=u[r[j]];xe?(x===0&&(x=K()),m[j]=xe(i[j])):m[j]=i[j]}var ve=a.currData,ae=c(...m);function Oe(F){return Ft(),x!==0&&J(x),l(F)}var Ue=s==null?void 0:s.async;return Tt(),a.currData!=ve?(o(!(ve&&a.currData),"We cannot start an async operation when one is already flight"),o(!(ve&&!a.currData),"We cannot stop an async operation in flight"),o(Ue,"The call to "+e+" is running asynchronously. If this was intended, add the async option to the ccall/cwrap call."),a.whenDone().then(Oe)):(ae=Oe(ae),Ue?Promise.resolve(ae):ae)},Mt=(e,t,r,i)=>(...s)=>Me(e,t,r,s,i),Rt=e=>{var t=de(e)+1,r=pe(t);return r&&fe(e,r,t),r};function Pt(){$e("fetchSettings")}var Re={54832:()=>performance.now(),54862:e=>performance.now()-e,54897:(e,t)=>globalThis.ulisp.call(P(e),t),54953:(e,t,r)=>{globalThis.ulisp.call(P(e),t,r)},55006:(e,t)=>globalThis.ulisp.call(P(e),t),55062:(e,t,r)=>{globalThis.ulisp.call(P(e),t,r)},55115:(e,t,r)=>{globalThis.ulisp.call(P(e),t,r)}};function Lt(e){return a.handleAsync(async()=>{await globalThis.ulisp.delay(e)})}function Dt(){return a.handleAsync(async()=>{const e=await globalThis.ulisp.readLine(),t=de(e)+1,r=pe(t);return fe(e,r,t),r})}function xt(e){return a.handleAsync(async()=>{const t=await globalThis.ulisp.readByte(e);return t===-1?-1:t<0||t>255?(console.error("Invalid byte generated",t),-1):t})}function Ot(e,t){globalThis.ulisp.writeByte(e,t)}function Ut(){return globalThis.ulisp.wait_for_tick()}var me={__assert_fail:lt,__asyncjs__delay_on_host:Lt,__asyncjs__read_byte_from_host:xt,__asyncjs__read_line_from_host:Dt,_abort_js:ct,_emscripten_throw_longjmp:ut,emscripten_asm_const_double:ft,emscripten_asm_const_int:mt,emscripten_resize_heap:yt,fd_close:vt,fd_seek:gt,fd_write:ht,invoke_ii:Xt,invoke_iii:Zt,invoke_vi:Qt,invoke_vii:qt,wait_for_tick_on_host:Ut,write_byte_to_host:Ot},w=await at(),Nt=n._free=v("free",1);n._print_version=v("print_version",0),n._setup=v("setup",0),n._stop_loop=v("stop_loop",0),n._evaluate=v("evaluate",1);var pe=v("malloc",1),ne=v("setThrew",2),Wt=w.emscripten_stack_init;w.emscripten_stack_get_free,w.emscripten_stack_get_base;var Pe=w.emscripten_stack_get_end,Bt=w._emscripten_stack_restore,jt=w._emscripten_stack_alloc,Le=w.emscripten_stack_get_current,Gt=n.dynCall_vi=v("dynCall_vi",2);n.dynCall_i=v("dynCall_i",1);var $t=n.dynCall_vii=v("dynCall_vii",3),Ht=n.dynCall_ii=v("dynCall_ii",2),zt=n.dynCall_iii=v("dynCall_iii",3);n.dynCall_iiii=v("dynCall_iiii",4),n.dynCall_jiji=v("dynCall_jiji",4);var Yt=v("asyncify_start_unwind",1),Vt=v("asyncify_stop_unwind",0),Jt=v("asyncify_start_rewind",1),Kt=v("asyncify_stop_rewind",0);function qt(e,t,r){var i=K();try{$t(e,t,r)}catch(s){if(J(i),s!==s+0)throw s;ne(1,0)}}function Xt(e,t){var r=K();try{return Ht(e,t)}catch(i){if(J(r),i!==i+0)throw i;ne(1,0)}}function Zt(e,t,r){var i=K();try{return zt(e,t,r)}catch(s){if(J(i),s!==s+0)throw s;ne(1,0)}}function Qt(e,t){var r=K();try{Gt(e,t)}catch(i){if(J(r),i!==i+0)throw i;ne(1,0)}}n.ccall=Me,n.cwrap=Mt,n.UTF8ToString=P,n.stringToNewUTF8=Rt;var er=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertI32PairToI53Checked","convertU32PairToI53","getTempRet0","setTempRet0","zeroMemory","growMemory","strError","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","runMainThreadEmAsm","jstoi_q","getExecutableName","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","asmjsMangle","asyncLoad","mmapAlloc","HandleAllocator","getNativeTypeSize","addOnInit","addOnPostCtor","addOnPreMain","addOnExit","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","uleb128Encode","generateFuncType","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","reallyNegative","unSign","strLen","reSign","formatString","intArrayFromString","intArrayToString","AsciiToString","stringToAscii","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","getEnvStrings","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","initRandomFill","randomFill","safeSetTimeout","setImmediateWrapped","safeRequestAnimationFrame","clearImmediateWrapped","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","isLeapYear","ydayFromDate","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar","FS_unlink","FS_createDataFile","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"];er.forEach(ze);var tr=["run","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","wasmExports","writeStackCookie","checkStackCookie","INT53_MAX","INT53_MIN","bigintToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","exitJS","getHeapMax","abortOnCannotGrowMemory","ENV","ERRNO_CODES","DNS","Protocols","Sockets","timers","warnOnce","readEmAsmArgsArray","readEmAsmArgs","runEmAsmFunction","jstoi_s","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","alignMemory","wasmTable","noExitRuntime","addOnPreRun","addOnPostRun","getCFunc","sigToWasmTypes","freeTableIndexes","functionsInTableMap","setValue","getValue","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","stringToUTF8","lengthBytesUTF8","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","flush_NO_FILESYSTEM","emSetImmediate","emClearImmediate_deps","emClearImmediate","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","SYSCALLS","preloadPlugins","FS_stdin_getChar_buffer","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","runAndAbortIfError","Asyncify","Fibers","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"];tr.forEach(be);var De;function rr(){Wt(),Ge()}function ye(){if(N>0){H=ye;return}if(rr(),Ve(),N>0){H=ye;return}function e(){var t;o(!De),De=!0,n.calledRun=!0,!O&&(Je(),A(n),(t=n.onRuntimeInitialized)==null||t.call(n),ee("onRuntimeInitialized"),o(!n._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),Ke())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),e()},1)):e(),Q()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();ee("preInit"),ye(),h=C;for(const e of Object.keys(n))e in R||Object.defineProperty(R,e,{configurable:!0,get(){_(`Access to module property ('${e}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return h}})();(()=>{var b=L;L=function(g){if(new.target)throw new Error("createLispWasmModule() should not be called with `new createLispWasmModule()`");return b(g)}})();var D=L;class G{constructor(){ge(this,"buffer","")}start(){this.buffer=""}push(g){this.buffer+=g}end(){let g=this.buffer.trimEnd();return this.buffer="",g}}async function Ne({createLispWasmModule:b,print:g,printError:R,parseJson:h=!0,jsonErrorMode:n="value"}){const A=new G;function k(...p){if(g)return g(...p);A.push(p.reduce((f,E)=>(f+=E,f),"")+`
`)}const C=["value","error","none"].reduce((p,f)=>(p[f]=n===f,p),{}),d=await b({print:k,printErr:R||k});d._setup();async function S(p,f={}){A.start();const E=d.stringToNewUTF8(`(progn ${p})`);await d.ccall("evaluate","void",["number"],[E],{async:!0}),d._free(E);const I=A.end();if(!h)return I;if(I==="nil")return null;if(I==="t")return!0;try{return JSON.parse(I)}catch(y){if(C.none)return;if(C.error)return y.originalValue=I,y;if(C.value)return I}}return{eval:S}}async function We(b={}){const{wasmPath:g="",tick:R,print:h,printError:n,readByte:A,writeByte:k,readLine:C}=b;return globalThis.ulisp={call(d,...S){switch(console.log("ulisp called",d,...S),d){case"analogRead":return 0;case"analogWrite":break;case"digitalRead":return 0}},async delay(d=0){return new Promise((S,p)=>{console.log("delay",d),setTimeout(S,parseInt(d,10))})},async readByte(d){return A?await A(d):""},writeByte(d,S){k&&k(d,S)},async readLine(){return C?await C():""},writeLine(d){h&&h(d)},writeLineError(d){n?n(d):h&&h(d)},escape(){return 0},wait_for_tick(){if(R)return R()},stop(){}},await Ne({print:h,printError:n||h,createLispWasmModule(d={}){return D({...d,locateFile(S,p){return g+S}})}})}let ie;const oe=new Map;async function Be(b){const{id:g,data:R,action:h,response:n}=b.data;if(h==="response"){const f=oe.get(g);f&&(f(n),oe.delete(g));return}if(h){console.log("Action",h);return}const{code:A,wasmPath:k=""}=R;let C=0;function d(f,...E){const I=`request-${Date.now()}-${Math.random()}`;return self.postMessage({requestId:I,action:f,args:E}),new Promise(y=>{oe.set(I,y)})}function S(f,...E){self.postMessage({action:f,args:E})}ie||(ie=await We({wasmPath:k,tick(){C++,self.postMessage({step:C})},print(f){self.postMessage({print:f})},printError(f){self.postMessage({printError:f})},readByte(f){return d("readByte",f)},readLine(){return d("readLine")},async writeByte(f,E){return S("writeByte",f,E)}}));const p=await ie.eval(A);self.postMessage({id:g,result:p})}self.addEventListener("message",function(b){Be(b)})})();
